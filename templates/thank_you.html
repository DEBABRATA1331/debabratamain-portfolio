{% extends 'base.html' %}
{% block title %}Thank You{% endblock %}

{% block content %}
<div class="container text-center mt-5" data-aos="zoom-in">
  <h2 class="fw-bold neon-glow" id="glowTitle">üéâ Thank You for Reaching Out!</h2>
  <p class="lead">I'll get back to you soon. Meanwhile ‚Äî test your skills and have fun! üéÆ</p>

  <!-- Flash message display -->
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div class="alert alert-success mt-3">{{ messages[0] }}</div>
    {% endif %}
  {% endwith %}

  <!-- Motivating Quote -->
  <p class="glow-yellow mt-4 fst-italic">‚ÄúInnovation distinguishes between a leader and a follower.‚Äù ‚Äî Steve Jobs</p>

  <!-- Reaction Time Game -->
  <div class="my-5 text-center">
    <h4 class="neon-text">Test Your Reaction Time ‚ö°</h4>
    <p class="glow-yellow">Click the button as soon as it turns blue!</p>
    <button id="reactionButton" class="btn neon-btn mt-3">Wait for it...</button>
    <p class="mt-3" id="reactionResult"></p>
  </div>

  <!-- Score Tracker -->
  <div class="my-5">
    <h4 class="neon-text">Score üéØ</h4>
    <div class="scoreboard">
      <span class="glow-score">Score: <span id="score">0</span></span>
    </div>
    <button class="btn neon-btn m-1" onclick="startScoring()">Start</button>
    <button class="btn neon-btn m-1" onclick="resetScore()">Reset</button>
  </div>

  <!-- Embedded Pong Game -->
  <div class="my-5">
    <h4 class="neon-text">Pong Challenge üèì</h4>
    <canvas id="pong" width="500" height="300" style="border: 2px solid #00f7ff; border-radius: 10px;"></canvas>
  </div>

  <!-- Back Button -->
  <div class="mt-5">
    <a href="{{ url_for('home') }}" class="btn neon-btn m-2">üè† Back to Home</a>
  </div>
</div>

<!-- üéâ Confetti -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
  window.onload = () => {
    confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 } });
    startGame();
    pongLoop();
  };
</script>

<!-- ‚ö° Reaction Time Game -->
<script>
  let startTime;
  const button = document.getElementById("reactionButton");
  const result = document.getElementById("reactionResult");

  function startGame() {
    button.textContent = "Wait for it...";
    button.disabled = true;
    button.style.background = "transparent";
    result.textContent = "";
    let delay = Math.floor(Math.random() * 3000) + 2000;
    setTimeout(() => {
      button.textContent = "Click!";
      button.style.background = "#00f7ff";
      button.disabled = false;
      startTime = new Date().getTime();
    }, delay);
  }

  button.addEventListener("click", () => {
    if (startTime) {
      let reactionTime = new Date().getTime() - startTime;
      result.innerHTML = `‚ö° Your Reaction Time: <strong>${reactionTime} ms</strong>`;
      button.style.background = "transparent";
      button.disabled = true;
    }
  });
</script>

<!-- üéØ Score Tracker -->
<script>
  let score = 0, intervalId = null;
  function startScoring() {
    if (!intervalId) {
      intervalId = setInterval(() => {
        score += Math.floor(Math.random() * 5 + 1);
        document.getElementById('score').textContent = score;
      }, 1000);
    }
  }
  function resetScore() {
    clearInterval(intervalId);
    intervalId = null;
    score = 0;
    document.getElementById('score').textContent = score;
  }
</script>

<!-- üïπÔ∏è Pong Game Script -->
<script>
  const canvas = document.getElementById("pong");
  const ctx = canvas.getContext("2d");
  let paddleHeight = 60, paddleWidth = 10, ballRadius = 8;
  let playerY = canvas.height / 2 - paddleHeight / 2;
  let aiY = playerY, ballX = canvas.width / 2, ballY = canvas.height / 2;
  let ballSpeedX = 4, ballSpeedY = 3;

  function drawRect(x, y, w, h, color) {
    ctx.fillStyle = color;
    ctx.fillRect(x, y, w, h);
  }

  function drawCircle(x, y, r, color) {
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.arc(x, y, r, 0, Math.PI * 2);
    ctx.fill();
  }

  function drawText(txt, x, y, color) {
    ctx.fillStyle = color;
    ctx.font = "20px monospace";
    ctx.fillText(txt, x, y);
  }

  function renderPong() {
    drawRect(0, 0, canvas.width, canvas.height, "#111");
    drawRect(0, playerY, paddleWidth, paddleHeight, "#00f7ff");
    drawRect(canvas.width - paddleWidth, aiY, paddleWidth, paddleHeight, "#00f7ff");
    drawCircle(ballX, ballY, ballRadius, "#ffffff");
  }

  function moveBall() {
    ballX += ballSpeedX;
    ballY += ballSpeedY;

    // Bounce
    if (ballY + ballRadius > canvas.height || ballY - ballRadius < 0) ballSpeedY *= -1;

    // Left paddle
    if (ballX - ballRadius < paddleWidth &&
        ballY > playerY && ballY < playerY + paddleHeight) ballSpeedX *= -1;

    // Right paddle (AI)
    if (ballX + ballRadius > canvas.width - paddleWidth &&
        ballY > aiY && ballY < aiY + paddleHeight) ballSpeedX *= -1;

    // Score reset
    if (ballX < 0 || ballX > canvas.width) {
      ballX = canvas.width / 2;
      ballY = canvas.height / 2;
      ballSpeedX *= -1;
    }

    // AI follow
    aiY += (ballY - (aiY + paddleHeight / 2)) * 0.1;
  }

  canvas.addEventListener("mousemove", (e) => {
    playerY = e.offsetY - paddleHeight / 2;
  });

  function pongLoop() {
    moveBall();
    renderPong();
    requestAnimationFrame(pongLoop);
  }
</script>

<!-- üí´ Glow Styles -->
<style>
  .neon-glow {
    color: #ffeb3b;
    text-shadow: 0 0 5px #ffeb3b, 0 0 15px #ffeb3b, 0 0 30px #ffeb3b;
    animation: pulse 2s infinite ease-in-out;
  }

  @keyframes pulse {
    0% { text-shadow: 0 0 5px #ffeb3b; }
    50% { text-shadow: 0 0 15px #ffeb3b, 0 0 25px #ffeb3b; }
    100% { text-shadow: 0 0 5px #ffeb3b; }
  }

  .glow-yellow {
    color: #ffeb3b;
    text-shadow: 0 0 5px #ffeb3b, 0 0 15px #ffeb3b;
  }

  .glow-score {
    color: #00f7ff;
    text-shadow: 0 0 5px #00f7ff, 0 0 15px #00f7ff;
    font-weight: bold;
  }
</style>
{% endblock %}
